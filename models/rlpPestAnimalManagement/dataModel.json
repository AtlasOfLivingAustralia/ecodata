{
  "title": "Controlling pest animals",
  "modelName": "RLP - Pest animal management",
  "dataModel": [
    {
      "dataType": "list",
      "name": "areasControlled",
      "columns": [
        {
          "name": "initialOrFollowup",
          "dataType": "text",
          "validate": "required",
          "constraints": [
            "Initial",
            "Follow-up"
          ]
        },
        {
          "dataType": "feature",
          "name": "site"
        },
        {
          "dataType": "number",
          "name": "areaControlledHa",
          "computed": {
            "expression": "$geom.areaHa(site)",
            "dependents": {
              "source": [
                "site"
              ]
            }
          }
        },
        {
          "dataType": "number",
          "name": "lengthControlledKm",
          "computed": {
            "expression": "$geom.lengthKm(site)",
            "dependents": {
              "source": [
                "site"
              ]
            }
          }
        },
        {
          "dataType": "list",
          "name": "pestAnimalsControlled",
          "columns": [
            {
              "dataType": "species",
              "description": "Pest species targeted for treatment (start typing a  scientific or common name for a species)",
              "name": "pestSpecies",
              "dwcAttribute": "scientificName",
              "validate": "required"
            },
            {
              "dataType": "text",
              "description": "The method used in this activity to manage pests",
              "name": "pestManagementMethod",
              "constraints": [
                "Aerial shoot",
                "Bait & trap",
                "Bait only",
                "Feral free enclosure",
                "Exclusion fencing",
                "Fumigation",
                "Ground shoot",
                "Trap & cull",
                "Trap & remove",
                "Other"
              ],
              "dwcAttribute": "treatmentMethod",
              "validate": "required"
            },
            {
              "dataType": "text",
              "name": "otherManagementMethod",
              "description": "Please specify the management method used if Other was selected in the Management Method column.",
              "behaviour": [
                {
                  "condition": "pestManagementMethod == \"Other\"",
                  "type": "enable"
                }
              ],
              "validate": "required,maxSize[100]"
            },
            {
              "name": "treatmentObjective",
              "dataType": "text",
              "validate": "required,maxSize[300]"
            },
            {
              "name": "individualsOrColonies",
              "dataType": "text",
              "validate": "required",
              "constraints": [
                "Colonies",
                "Individuals"
              ]
            },
            {
              "name": "individualsOrColoniesRemoved",
              "dataType": "number",
              "validate": "required"
            }
          ]
        }
      ]
    },
    {
      "name":"photographicEvidence",
      "dataType":"image"
    }
  ],
  "viewModel": [
    {
      "items": [
        {
          "type": "repeat",
          "source": "areasControlled",
          "userAddedRows":true,
          "addRowText":"Add a new controlled area",
          "items": [
            {
              "type": "row",
              "items": [
                {
                  "preLabel": "Initial or follow-up control?",
                  "source": "initialOrFollowup",
                  "type": "selectOne",
                  "css": "span3"
                },
                {
                  "type": "feature",
                  "source": "site",
                  "preLabel": "Site/s where pest control was undertaken",
                  "css": "span2"
                },
                {
                  "type": "number",
                  "source": "areaControlledHa",
                  "preLabel": "Area (ha) treated for pest animals",
                  "readonly": "readonly",
                  "css": "span2"
                },
                {
                  "type": "number",
                  "source": "lengthControlledKm",
                  "preLabel": "Length (km) treated for pest animals",
                  "readonly": "readonly",
                  "css": "span2"
                }
              ]
            },
            {
              "type": "row",
              "items": [
                {
                  "source": "pestAnimalsControlled",
                  "columns": [
                    {
                      "title": "Target pest species",
                      "source": "pestSpecies",
                      "type": "speciesSelect",
                      "width": "40%"
                    },
                    {
                      "title": "Type of control",
                      "source": "pestManagementMethod",
                      "type": "selectOne",
                      "width": "10%"
                    },
                    {
                      "title": "Type of control (if other)",
                      "source": "otherManagementMethod",
                      "type": "text",
                      "width": "10%"
                    },
                    {
                      "title": "Treatment objective",
                      "source": "treatmentObjective",
                      "type": "textarea",
                      "width": "20%"
                    },
                    {
                      "title": "Individuals or colonies?",
                      "source": "individualsOrColonies",
                      "type": "selectOne",
                      "width": "10%"
                    },
                    {
                      "title": "Number of individuals or colonies removed / destroyed",
                      "source": "individualsOrColoniesRemoved",
                      "type": "number",
                      "width": "10%"
                    }
                  ],
                  "userAddedRows": true,
                  "type": "table",
                  "addRowText":"Add a species"
                }
              ]
            }
          ]
        },
        {
          "type":"row",
          "items":[
            {
              "type":"image",
              "source":"photographicEvidence",
              "preLabel":"Optionally attach photos"
            }
          ]
        }
      ],
      "type": "section"
    }
  ]
}